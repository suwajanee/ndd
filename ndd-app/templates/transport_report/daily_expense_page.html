{% extends 'base.html' %}
{% load static %}

{% block title %} {{ title }} {% endblock %}

{% block extra_head %}
    <link rel="stylesheet" href="{% static 'css/style_transport_report.css' %}" />
{% endblock %}

{% block content %}
<div id="daily-expense-page">
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb m-0 bg-white border-bottom">
            <!-- <li class="breadcrumb-item"><a href="{% url 'dashboard-page' %}">Dashboard</a></li> -->
            <li class="breadcrumb-item"><a href="{% url 'dashboard-page' %}">รายงานการวิ่งงาน</a></li>
            <li class="breadcrumb-item">ค่าใช้จ่าย</li>
            <li class="breadcrumb-item active" aria-current="page">{% verbatim %}{{ date|formatDate }} ({{ co.toUpperCase() }}){% endverbatim %}</li>
        </ol>
    </nav>


    <div class="col-12 container">
        {% verbatim %}
            <div class="row">
                <input type="date" class="form-control m-3 col-2" v-model="date" @change="filterDate()" required>
                <select class="custom-select my-3 col-3" style="height: 40px;">
                    <option>555555555555555555555</option>
                </select>

                <div class="switch-field m-3 position-absolute" style="right:0;" @change="filterDate()">
                    <input type="radio" id="work_ndd" v-model="co" value="ndd" />
                    <label for="work_ndd">NDD</label>
                    <input type="radio" id="work_vts" v-model="co" value="vts" />
                    <label for="work_vts">VTS</label>
                </div>
            </div>
            
            

            <h4 class="text-center">{{ date|formatDate }}</h4>
            <table class="table table-hover table-bordered text-center">
                <thead>
                    <tr>
                        <th rowspan=2 class="align-middle">วันที่</th>
                        <th rowspan=2 class="align-middle">ชื่อ - นามสกุล</th>
                        <th rowspan=2 class="align-middle">เบอร์รถ</th>
                        <th rowspan=2 class="align-middle">เลขที่ใบงาน</th>
                        <th rowspan=2 class="align-middle">ชื่อลูกค้า</th>

                        <th colspan=8 class="align-middle">ค่าใช้จ่ายของบริษัท</th>
                        <th colspan=4 class="align-middle">สำรองจ่ายแทนลูกค้า</th>

                        <th rowspan=2 class="align-middle">รวมค่าใช้จ่าย</th>
                    </tr>
                    <tr>
                        <th class="align-middle">ทางด่วน</th>
                        <th class="align-middle">ผ่านท่า</th>
                        <th class="align-middle">ทำยาง</th>
                        <th class="align-middle">ตำรวจ</th>
                        <th class="align-middle">ช, ค่ายก</th>
                        <th class="align-middle">ค่าบริการ<br>รับ-คืนตู้ฯ</th>
                        <th class="align-middle">อื่นๆ</th>
                        <th class="align-middle">รวม</th>

                        <th class="align-middle">ค่าคืนตู้</th>
                        <th class="align-middle">ผ่านท่า</th>
                        <th class="align-middle">อื่นๆ</th>
                        <th class="align-middle">รวม</th>
                    </tr>
                </thead>
                <tbody v-if="report_list.length" class="bg-white">    
                    <tr v-for="report in report_list">
                        <td>{{ report.work_order.work_date|formatDate }}</td>
                        <td class="text-left">{{ report.work_order.driver.employee.name_title }} {{ report.work_order.driver.employee.first_name }} {{ report.work_order.driver.employee.last_name }}</td>
                        <td>{{ report.work_order.truck.number }}</td>
                        <td>
                            {{ report.work_order.work.work_id }}
                            <template v-if="report.work_order.order_type"> / {{ report.work_order.order_type }} <template v-if="report.work_order.double_container">+</template></template>
                        </td>
                        <td>{{ report.work_order.work.principal.name }}</td>

                        <td>{{ eval(report.co_expense.toll)|currencyCommas}}</td>
                        <td>{{ report.co_expense.co_gate|currencyCommas }}</td>
                        <td>{{ report.co_expense.tire|currencyCommas }}</td>
                        <td>{{ report.co_expense.fine|currencyCommas }}</td>
                        <td>{{ report.co_expense.thc|currencyCommas }}</td>
                        <td>{{ report.co_expense.service|currencyCommas }}</td>
                        <td>{{ report.co_expense.co_other|currencyCommas }}</td>

                        <td>{{ report.total_expense.company|currencyCommas }}</td>

                        <td>{{ report.cus_expense.return|currencyCommas }}</td>
                        <td>{{ report.cus_expense.cus_gate|currencyCommas }}</td>
                        <td>{{ report.cus_expense.cus_other|currencyCommas }}</td>

                        <td>{{ report.total_expense.customer|currencyCommas }}</td>

                        <td>{{ report.total_expense.company + report.total_expense.customer|currencyCommas }}</td>

                    </tr>
                    
                </tbody>
                <tbody v-else>
                    <tr>
                        <td colspan=18 class="text-center text-secondary">
                            ไม่พบข้อมูล
                        </td>
                    </tr>
                </tbody>
            </table>
            
        </div>
    {% endverbatim %}
</div>


<script type="application/javascript" src="{% static 'js/app_transport_report_daily_expense.js' %}"></script>
<script type="application/javascript" src="{% static 'js/utility/functions.js' %}"></script>
<script type="application/javascript" src="{% static 'js/utility/filters.js' %}"></script>


<script type="application/javascript">

    window.addEventListener("load", function() {
        console.log(0)
        console.log("{{ co }}")
        daily_expense_page.reload("{{ date }}", "{{ co }}")
        // transport_report_page.reload()
    })

</script>

{% endblock %}
