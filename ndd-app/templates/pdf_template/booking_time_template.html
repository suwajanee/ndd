{% load staticfiles %}


<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

  <title>Time Print</title>
  
  <link rel="stylesheet" href="{{ static_dir }}/css/style-pdf.css" />

  <style type='text/css'>
    /* Size and frame */
    @page {
      size: a4 landscape;
      /* margin: 10pt; */

      @frame { 
        -pdf-frame-content: head_table;
        left: 0.25in; width: 11.2in; top: 0.5in; height: auto;
      }

      @frame { 
        left: 0.25in; width: 11.2in; top: 1in; height: auto;
      }

    }

    @font-face {
      font-family: THSarabunNew; 
      src: url("{{ static_dir }}/fonts/thsarabunnew-webfont.ttf"); 
    } 

    html {
      font-family: THSarabunNew;
    }

  </style>

</head>

<body>
  <div id="head_table">
    <table class="time-table">

      <thead class="time-head">

        <th rowspan=2 width=4%>Date</th>
        <th rowspan=2 width=4%>Customer</th>
        <th rowspan=2 width=6%>Shipper</th>
        <th rowspan=2 width=4%>Agent</th>
        <th rowspan=2 width=3.5%>Size</th>
        <th rowspan=2 width=8%>Booking</th>

        <th rowspan=2 width=2.5%>TR</th>
        <th rowspan=2 width=4%>From</th>
        <th rowspan=2 width=2.5%>TR</th>
        <th rowspan=2 width=4%>Factory</th>
        <th rowspan=2 width=2.5%>TR</th>
        <th rowspan=2 width=2.5%>TR</th>
        <th rowspan=2 width=4%>To</th>

        <th rowspan=2 width=6%>Container no</th>
        <th rowspan=2 width=5%>Seal no</th>

        <th rowspan="2" width=5%>เลขที่ใบงาน</th>

        <th colspan="2">ลานรับตู้</th>
        <th colspan="4">Factory</th>
        <th colspan="2">ลานส่งตู้</th>
        <tr>
            <th width=4%>In</th>
            <th width=4%>Out</th>

            <th width=4%>In</th>
            <th width=4%>Start</th>
            <th width=4%>Finish</th>
            <th width=4%>Out</th>

            <th width=4%>In</th>
            <th width=4%>Out</th>
        </tr>
      </thead>
    </table>
  </div>

    <div id="content_table">
      <table class="time-table" >

        <tbody >
            {% for booking in bookings %}

            <tr>
              <td width=4%>{{ booking.date | date:'d-m-y' }}</td>
              <td width=4%>{{ booking.principal | truncatechars:8 }}</td>
              <td width=6% >{{ booking.shipper }}</td>
              <td width=4%>{{ booking.agent | truncatechars:8 }}</td>
              <td width=3.5%>{{ booking.size }}</td>
              
              <td width=8% style="min-width:200px; background-color:
                  {% ifchanged booking.booking_no %}
                      {% cycle "#9977b4" "#dd86b9" "#f497a9" "#f9b489" "#fdcd79" "#fff68f" "#b6d884" "#81cbb5" "#6acade" "#72abdd" as rowcolors %}
                  {% else %}
                      {{ rowcolors }}
                  {% endifchanged %}"
              class="text-center text-dark text-8">
                {{ booking.booking_no }}
              </td>

              <td width=2.5%>{{ booking.pickup_tr }}</td>
              <td width=4%>{{ booking.pickup_from }}</td>
              <td width=2.5%>{{ booking.forward_tr }}</td>
              <td width=4%>{{ booking.factory }}</td>
              <td width=2.5%>{{ booking.backward_tr }}</td>
              <td width=2.5%>{{ booking.return_tr }}</td>
              <td width=4%>{{ booking.return_to }}</td>

              <td width=6%>{{ booking.container_no | truncatechars:12 }}</td>
              <td width=5%>{{ booking.seal_no | truncatechars:12 }}</td>

              <td width=5%>{{ booking.work_id }}</td>

              {% load parse_date %}
              {% load split %}
                    <td width=4%>
                      {% with booking.pickup_in_time|split:"//" as pickup_in_time %}
                        {% if pickup_in_time.0 %}
                          {{ pickup_in_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.pickup_date | date:'d-m-y'}}
                        {% endif %}
                        {{ pickup_in_time.1 | truncatechars:8 }}
                      {% endwith %}
                    </td>
                    <td width=4%>
                      {% with booking.pickup_out_time|split:"//" as pickup_out_time %}
                        {% if pickup_out_time.0 %}
                          {{ pickup_out_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.pickup_date | date:'d-m-y'}}
                        {% endif %}
                        {{ pickup_out_time.1 | truncatechars:8 }}
                      {% endwith %}
                    </td>
                    <td width=4%>
                      {% with booking.factory_in_time|split:"//" as factory_in_time %}
                        {% if factory_in_time.0 %}
                          {{ factory_in_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.factory_date | date:'d-m-y'}}
                        {% endif %}
                        {{ factory_in_time.1 | truncatechars:8 }}
                      {% endwith %}  
                    </td>
                    <td width=4%>
                      {% with booking.factory_load_start_time|split:"//" as factory_load_start_time %}
                        {% if factory_load_start_time.0 %}
                          {{ factory_load_start_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.factory_date | date:'d-m-y'}}
                        {% endif %}
                        {{ factory_load_start_time.1 | truncatechars:8 }}
                      {% endwith %}  
                    </td>
                    <td width=4%>
                      {% with booking.factory_load_finish_time|split:"//" as factory_load_finish_time %}
                        {% if factory_load_finish_time.0 %}
                          {{ factory_load_finish_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.factory_date | date:'d-m-y'}}
                        {% endif %}
                        {{ factory_load_finish_time.1 | truncatechars:8 }}
                      {% endwith %}  
                    </td>
                    <td width=4%>
                      {% with booking.factory_out_time|split:"//" as factory_out_time %}
                        {% if factory_out_time.0 %}
                          {{ factory_out_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.factory_date | date:'d-m-y'}}
                        {% endif %}
                        {{ factory_out_time.1 | truncatechars:8 }}
                      {% endwith %}  
                    </td>

                    <td width=4%>
                      {% with booking.return_in_time|split:"//" as return_in_time %}
                        {% if return_in_time.0 %}
                          {{ return_in_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.return_date | date:'d-m-y'}}
                        {% endif %}
                        {{ return_in_time.1 | truncatechars:8 }}
                      {% endwith %} 
                    </td>
                    <td width=4%>
                      {% with booking.return_out_time|split:"//" as return_out_time %}
                        {% if return_out_time.0 %}
                          {{ return_out_time.0|parse_date | date:'d-m-y' }}
                        {% else %}
                          {{ booking.return_date | date:'d-m-y'}}
                        {% endif %}
                        {{ return_out_time.1 | truncatechars:8 }}
                      {% endwith %} 
                    </td>

            
            </tr>
            
            
            {% if forloop.counter|divisibleby:15 == 1 and not forloop.last %}
                    </tbody>
                </table>

                <pdf:nextpage>
                    <table class="time-table">
                        <tbody>

            {% endif %}

            {% endfor %}
        </tbody>
      </table>

      </div>
      



</body>
</html>